# 🚀 TW-Overlay v1.3.0 업데이트 요약

이번 업데이트는 앱의 핵심 엔진을 PowerShell에서 **Native Win32 API**로 전면 교체하여 성능, 안정성, 그리고 사용자 경험을 대폭 향상시켰습니다.

## 🛠 핵심 엔진 개편
- **Native Window Tracker (Koffi)**: PowerShell 기반 추적 방식을 폐기하고 `koffi` 라이브러리를 통해 Win32 API를 직접 호출합니다.
  - **응답 속도 향상**: 자식 프로세스 통신 오버헤드 제거로 창 추적 반응성이 대폭 개선되었습니다.
  - **안정성 확보**: 시스템의 PowerShell 실행 정책에 영향을 받지 않으며 어디서나 안정적으로 작동합니다.
- **Native ScreenWatcher (GDI)**: 장판 감시 기능을 Chromium 비디오 스트림 방식에서 GDI 직접 캡처 방식으로 전환했습니다.
  - **에러 해결**: 최근 일부 환경에서 발생하던 `CreateForWindow failed (Access Denied)` 에러를 원천 차단했습니다.
  - **저부하 고효율**: 감시 영역만 정밀하게 캡처하여 CPU 점유율을 획기적으로 낮췄습니다.

## 🪟 창 관리 및 Z-Order 최적화
- **동적 Z-Order 스택**: 오버레이 창들이 사용자가 마지막으로 클릭하거나 연 순서대로 쌓이는 지능형 스택 시스템을 도입했습니다.
- **지능형 샌드위치 로직**:
  - 게임이나 앱이 활성화된 경우: 오버레이가 게임 위에 단단히 고정됩니다.
  - 다른 앱(브라우저 등)이 활성화된 경우: 오버레이가 게임 위에는 붙어있되, 브라우저 뒤로는 자연스럽게 숨어 작업 방해를 최소화합니다.
- **깜박임 방지**: 포커스 상태를 캐싱하여 불필요한 레이어 변경 호출을 최소화하고, 부드러운 전환 플래그를 적용했습니다.

## ⚡ 성능 최적화 (Memory & CPU)
- **메모리 풀링 (Singleton Buffers)**: 트래커와 감시자 모듈에서 매 주기마다 발생하던 대량의 메모리 할당(`Buffer.alloc`)을 제거하고 재사용 버퍼를 도입하여 가비지 컬렉션(GC)으로 인한 CPU 스파이크를 해결했습니다.
- **폴링 효율화**: 위치 변화 감지 시 무거운 JSON 연산을 제거하고 좌표 속성 직접 비교 방식으로 개선했습니다.

## ⚙️ 기능 및 UI 개선
- **장판 감지 임계치 상향**: 사용자 설정 범위를 0.5% ~ 50.0%로 확대하여 감도 조절 폭을 넓혔습니다. (기본값 10.0% 최적화)
- **DPI 스케일링 보정**: 고해상도 모니터 및 배율 설정 환경에서도 감시 영역이 어긋나지 않도록 물리 좌표 보정 로직을 적용했습니다.
- **용어 정제**: 사용자 이해를 돕기 위해 장판 감지 관련 용어를 '밀도'에서 '비율'로 통일했습니다.

## ⚡ 게임 네트워크 최적화 (Fast Ping)
- **네이글 알고리즘(Nagle's Algorithm) 최적화 기능**: 윈도우 패킷 전송 지연 기능을 버튼 하나로 제어하여 게임 응답 속도(핑)를 개선할 수 있습니다.
- **안전한 제어 엔진**: PowerShell의 Base64 인코딩 방식을 도입하여 구문 오류를 원천 차단하고, 관리자 권한 여부를 자동으로 감지하여 안내합니다.
- *정보 출처: 파덕의 IT 블로그 (네이글 알고리즘 최적화)*

## 🎨 환경 설정 UI 개편 및 메뉴 관리
- **탭 분리 시스템 도입**: 설정 항목을 '일반 설정'과 '오버레이 설정'으로 분리하여 가독성과 접근성을 높였습니다.
- **사이드바 메뉴 관리**: 사용자의 필요에 따라 특정 메뉴(약어 사전, 버프 백과 등)를 숨기거나 보일 수 있는 커스터마이징 기능을 추가했습니다.
- **디자인 일관성 강화**: 전체 설정 화면에 보라색(Purple) 브랜드 컬러와 카드형 레이아웃을 적용하고, 다크 모드에서의 가독성(드롭다운 목록 등)을 개선했습니다.

## 🖱 마우스 투과 제어 및 편의성
- **사이드바 제어 버튼 추가**: 단축키(Ctrl+Shift+T) 외에도 사이드바 하단 버튼을 통해 오버레이 창의 마우스 투과 상태를 직관적으로 제어하고 상태를 확인할 수 있습니다.
- **안정성 강화**: 창 닫기 시 상태 초기화 로직을 추가하고, 네트워크 작업 시 타임아웃을 설정하여 앱의 반응성을 보장했습니다.

## 💎 전방위 UI 리팩토링 및 일관성 강화
- **디자인 토큰 기반 개편**: `.gemini/DESIGN_TOKENS.md` 가이드라인에 따라 앱 전체(스플래시, 오버레이, 약어 사전, 버프 백과, 갤러리, 감시 영역 등)의 UI를 고퀄리티 다크 테마와 유리 질감(Glassmorphism)으로 통일했습니다.
- **시그니처 컬러 적용**: TW-Overlay의 정체성인 **보라색(Purple)**을 핵심 시각적 포인트로 모든 화면에 적용하여 브랜드 일관성을 높였습니다.
- **애니메이션 고도화**: 스플래시 화면의 플로팅 효과, 로딩 바의 쉬머(Shimmer) 애니메이션, 버튼 클릭 피드백(`active:scale-95`) 등을 추가하여 역동적인 사용자 경험을 제공합니다.

## 🚀 응답성 최적화 (UX Responsiveness)
- **창 로딩 속도 개선**: 환경 설정 창을 열 때 수천 개의 아이콘을 즉시 처리하던 로직을 **지연 실행(On-demand)** 방식으로 변경하여, 창이 뜨는 순간의 버벅임(Stuttering)을 완벽히 제거했습니다.
- **드래그 영역 정밀화**: 각 창의 드래그 핸들 영역을 헤더로 제한하여 내부 입력창(Input) 및 버튼과의 클릭 간섭 문제를 해결했습니다.

---
최종 수정일: 2026-02-22
작성자: Gemini CLI Agent
